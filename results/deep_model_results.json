{
  "model": "PI-TFT (Physics-Informed Temporal Fusion Transformer)",
  "best_epoch": 36,
  "training_time_minutes": 13.175001474221547,
  "optimal_threshold": 0.2639383375644684,
  "temperature": 0.6179193258285522,
  "use_density": true,
  "test": {
    "loss": 0.021245601093944383,
    "auc_pr": 0.5076785607710974,
    "auc_roc": 0.946749355627952,
    "f1_at_50": 0.0,
    "n_positive": 73,
    "n_total": 2167,
    "pos_rate": 0.03368712589144707,
    "f1": 0.5185185137773299,
    "optimal_threshold": 0.2639383375644684,
    "threshold": 0.2639383375644684,
    "recall_at_prec_30": 0.7808219178082192,
    "recall_at_prec_50": 0.4931506849315068,
    "recall_at_prec_70": 0.2876712328767123,
    "mae_log": 0.10174570232629776,
    "rmse_log": 0.15394317551905587,
    "mae_km": 1533.616943359375,
    "median_abs_error_km": 926.875
  },
  "test_calibrated": {
    "auc_pr": 0.5076785607710974,
    "auc_roc": 0.946749355627952,
    "f1_at_50": 0.0,
    "n_positive": 73,
    "n_total": 2167,
    "pos_rate": 0.03368712589144707,
    "f1": 0.5185185137773299,
    "optimal_threshold": 0.15979407727718353,
    "threshold": 0.15979407727718353,
    "recall_at_prec_30": 0.7808219178082192,
    "recall_at_prec_50": 0.4931506849315068,
    "recall_at_prec_70": 0.2876712328767123
  },
  "history": [
    {
      "epoch": 1,
      "train_loss": 6.801268232190931,
      "val_loss": 5.25680010659354,
      "val_auc_pr": 0.007896529454622946,
      "val_f1": 0.019323671026161646,
      "val_mae_log": 7.11151123046875
    },
    {
      "epoch": 2,
      "train_loss": 3.834329532932591,
      "val_loss": 2.7224787643977573,
      "val_auc_pr": 0.010594418921027337,
      "val_f1": 0.023529411193771638,
      "val_mae_log": 5.041237831115723
    },
    {
      "epoch": 3,
      "train_loss": 1.955074778118649,
      "val_loss": 1.1283516032355172,
      "val_auc_pr": 0.008480584727743306,
      "val_f1": 0.021505376131344667,
      "val_mae_log": 3.112034797668457
    },
    {
      "epoch": 4,
      "train_loss": 0.6309667991625296,
      "val_loss": 0.2000983421291624,
      "val_auc_pr": 0.047413803659580166,
      "val_f1": 0.11764705467128042,
      "val_mae_log": 1.1961653232574463
    },
    {
      "epoch": 5,
      "train_loss": 0.13499785540877163,
      "val_loss": 0.02656353052173342,
      "val_auc_pr": 0.05766442486817594,
      "val_f1": 0.15999999680000007,
      "val_mae_log": 0.29869771003723145
    },
    {
      "epoch": 6,
      "train_loss": 0.07689017317182309,
      "val_loss": 0.02750414184161595,
      "val_auc_pr": 0.134885373440643,
      "val_f1": 0.27272726921487606,
      "val_mae_log": 0.3075650930404663
    },
    {
      "epoch": 7,
      "train_loss": 0.08175783813805193,
      "val_loss": 0.07211375555821828,
      "val_auc_pr": 0.18529914529914526,
      "val_f1": 0.4285714239795918,
      "val_mae_log": 0.6812126040458679
    },
    {
      "epoch": 8,
      "train_loss": 0.07750273872468923,
      "val_loss": 0.027415024914911816,
      "val_auc_pr": 0.13237697916045849,
      "val_f1": 0.3157894698060942,
      "val_mae_log": 0.35104697942733765
    },
    {
      "epoch": 9,
      "train_loss": 0.06653158048520218,
      "val_loss": 0.01911477212394987,
      "val_auc_pr": 0.20693184703085693,
      "val_f1": 0.374999995703125,
      "val_mae_log": 0.2960411608219147
    },
    {
      "epoch": 10,
      "train_loss": 0.0626621154917253,
      "val_loss": 0.020604882389307022,
      "val_auc_pr": 0.3348872180451128,
      "val_f1": 0.5454545404958678,
      "val_mae_log": 0.23688556253910065
    },
    {
      "epoch": 11,
      "train_loss": 0.0617836594581604,
      "val_loss": 0.012763384197439467,
      "val_auc_pr": 0.1294155844155844,
      "val_f1": 0.22222221920438956,
      "val_mae_log": 0.1817978173494339
    },
    {
      "epoch": 12,
      "train_loss": 0.05554375463240856,
      "val_loss": 0.01185049262962171,
      "val_auc_pr": 0.24263038548752833,
      "val_f1": 0.36363635867768596,
      "val_mae_log": 0.15147316455841064
    },
    {
      "epoch": 13,
      "train_loss": 0.05319682077781574,
      "val_loss": 0.017937806567975452,
      "val_auc_pr": 0.2786109128966272,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.21772687137126923
    },
    {
      "epoch": 14,
      "train_loss": 0.05603743799634882,
      "val_loss": 0.012255215285612004,
      "val_auc_pr": 0.1654839208410637,
      "val_f1": 0.3076923029585799,
      "val_mae_log": 0.12889182567596436
    },
    {
      "epoch": 15,
      "train_loss": 0.052231158416818926,
      "val_loss": 0.008827194571495056,
      "val_auc_pr": 0.30569487983281085,
      "val_f1": 0.4705882311418686,
      "val_mae_log": 0.11871597170829773
    },
    {
      "epoch": 16,
      "train_loss": 0.050459702796227225,
      "val_loss": 0.006688231070126806,
      "val_auc_pr": 0.3174495864073329,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.11670727282762527
    },
    {
      "epoch": 17,
      "train_loss": 0.05048987201943591,
      "val_loss": 0.012136828287371568,
      "val_auc_pr": 0.209023569023569,
      "val_f1": 0.3529411723183391,
      "val_mae_log": 0.15395033359527588
    },
    {
      "epoch": 18,
      "train_loss": 0.05087649694367035,
      "val_loss": 0.007568871269800833,
      "val_auc_pr": 0.2673856209150327,
      "val_f1": 0.3999999962500001,
      "val_mae_log": 0.1411171853542328
    },
    {
      "epoch": 19,
      "train_loss": 0.050642090935159374,
      "val_loss": 0.0066412134495164666,
      "val_auc_pr": 0.27475908192734455,
      "val_f1": 0.3999999955555556,
      "val_mae_log": 0.0915408581495285
    },
    {
      "epoch": 20,
      "train_loss": 0.04991532632628003,
      "val_loss": 0.0055730888686542,
      "val_auc_pr": 0.24940384615384617,
      "val_f1": 0.33333332932098775,
      "val_mae_log": 0.10347151011228561
    },
    {
      "epoch": 21,
      "train_loss": 0.049406778288854133,
      "val_loss": 0.008397463309977735,
      "val_auc_pr": 0.22877207681961503,
      "val_f1": 0.2857142816326531,
      "val_mae_log": 0.15620921552181244
    },
    {
      "epoch": 22,
      "train_loss": 0.04929839575008766,
      "val_loss": 0.0075396452365177015,
      "val_auc_pr": 0.3359158185268243,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.11639901250600815
    },
    {
      "epoch": 23,
      "train_loss": 0.04896112705606061,
      "val_loss": 0.007832049591732877,
      "val_auc_pr": 0.3431446821152704,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.10894307494163513
    },
    {
      "epoch": 24,
      "train_loss": 0.048813931744646384,
      "val_loss": 0.0061542981836412635,
      "val_auc_pr": 0.3559577677224736,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.07847719639539719
    },
    {
      "epoch": 25,
      "train_loss": 0.04768835706888019,
      "val_loss": 0.006223144009709358,
      "val_auc_pr": 0.3659761291340239,
      "val_f1": 0.421052627700831,
      "val_mae_log": 0.14390207827091217
    },
    {
      "epoch": 26,
      "train_loss": 0.04840076712740434,
      "val_loss": 0.0067752449374113765,
      "val_auc_pr": 0.2586657651566374,
      "val_f1": 0.34782608355387534,
      "val_mae_log": 0.1449323147535324
    },
    {
      "epoch": 27,
      "train_loss": 0.047609428044509246,
      "val_loss": 0.0065139371103474075,
      "val_auc_pr": 0.34384112619406737,
      "val_f1": 0.34782608355387534,
      "val_mae_log": 0.09073375165462494
    },
    {
      "epoch": 28,
      "train_loss": 0.04662630880201185,
      "val_loss": 0.006256445976240295,
      "val_auc_pr": 0.33832141293241863,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.07596895098686218
    },
    {
      "epoch": 29,
      "train_loss": 0.04634691820152708,
      "val_loss": 0.005017333896830678,
      "val_auc_pr": 0.336514012303486,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.07677556574344635
    },
    {
      "epoch": 30,
      "train_loss": 0.04663669626052315,
      "val_loss": 0.004762223763723991,
      "val_auc_pr": 0.24682988580047405,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.08992886543273926
    },
    {
      "epoch": 31,
      "train_loss": 0.046282403110652355,
      "val_loss": 0.003826435888186097,
      "val_auc_pr": 0.2284485407066052,
      "val_f1": 0.3999999962500001,
      "val_mae_log": 0.06141701713204384
    },
    {
      "epoch": 32,
      "train_loss": 0.04575154318197353,
      "val_loss": 0.005115043604746461,
      "val_auc_pr": 0.3611255411255411,
      "val_f1": 0.3999999962500001,
      "val_mae_log": 0.09008380770683289
    },
    {
      "epoch": 33,
      "train_loss": 0.046043931763317135,
      "val_loss": 0.004483342935730304,
      "val_auc_pr": 0.36333333333333334,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.10232321172952652
    },
    {
      "epoch": 34,
      "train_loss": 0.04492839058307377,
      "val_loss": 0.007276699944798436,
      "val_auc_pr": 0.3461904761904762,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.10686437785625458
    },
    {
      "epoch": 35,
      "train_loss": 0.04576677558188503,
      "val_loss": 0.004259714224774923,
      "val_auc_pr": 0.37718954248366016,
      "val_f1": 0.3999999962500001,
      "val_mae_log": 0.0769796371459961
    },
    {
      "epoch": 36,
      "train_loss": 0.044130372638637956,
      "val_loss": 0.004274079659288483,
      "val_auc_pr": 0.4215151515151515,
      "val_f1": 0.4444444395061729,
      "val_mae_log": 0.09318451583385468
    },
    {
      "epoch": 37,
      "train_loss": 0.04556343443691731,
      "val_loss": 0.0053521015548280305,
      "val_auc_pr": 0.3828373015873016,
      "val_f1": 0.421052627700831,
      "val_mae_log": 0.11446798592805862
    },
    {
      "epoch": 38,
      "train_loss": 0.04497031863476779,
      "val_loss": 0.005016647595246988,
      "val_auc_pr": 0.38186813186813184,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.11497646570205688
    },
    {
      "epoch": 39,
      "train_loss": 0.04312905277553442,
      "val_loss": 0.003749881671475513,
      "val_auc_pr": 0.3595238095238095,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.05548140034079552
    },
    {
      "epoch": 40,
      "train_loss": 0.04352163130769859,
      "val_loss": 0.005372332009885993,
      "val_auc_pr": 0.3503288825869471,
      "val_f1": 0.34782608355387534,
      "val_mae_log": 0.08230870962142944
    },
    {
      "epoch": 41,
      "train_loss": 0.043740846146200156,
      "val_loss": 0.0039979582319834405,
      "val_auc_pr": 0.41458333333333336,
      "val_f1": 0.3999999962500001,
      "val_mae_log": 0.08734633028507233
    },
    {
      "epoch": 42,
      "train_loss": 0.04409235781310378,
      "val_loss": 0.005109895303446267,
      "val_auc_pr": 0.2524756335282651,
      "val_f1": 0.33333333003472226,
      "val_mae_log": 0.07870446890592575
    },
    {
      "epoch": 43,
      "train_loss": 0.043179894389735685,
      "val_loss": 0.005041864268215639,
      "val_auc_pr": 0.26508912655971484,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.07578516006469727
    },
    {
      "epoch": 44,
      "train_loss": 0.04234155755792115,
      "val_loss": 0.0038543779269925187,
      "val_auc_pr": 0.3427519893899204,
      "val_f1": 0.33333333055555564,
      "val_mae_log": 0.06378159672021866
    },
    {
      "epoch": 45,
      "train_loss": 0.043199574021068776,
      "val_loss": 0.00448337330349854,
      "val_auc_pr": 0.38693977591036416,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.08112290501594543
    },
    {
      "epoch": 46,
      "train_loss": 0.04324697579282361,
      "val_loss": 0.004593804511906845,
      "val_auc_pr": 0.3657142857142857,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.12126877903938293
    },
    {
      "epoch": 47,
      "train_loss": 0.042983541144309814,
      "val_loss": 0.0034202520120223717,
      "val_auc_pr": 0.36703703703703705,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.05318637564778328
    },
    {
      "epoch": 48,
      "train_loss": 0.04088504479543583,
      "val_loss": 0.0037384599480511887,
      "val_auc_pr": 0.35812684047978166,
      "val_f1": 0.38461538150887575,
      "val_mae_log": 0.0607416033744812
    },
    {
      "epoch": 49,
      "train_loss": 0.0411647165143812,
      "val_loss": 0.0038923417118244936,
      "val_auc_pr": 0.37444444444444447,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.07454186677932739
    },
    {
      "epoch": 50,
      "train_loss": 0.04235347539589212,
      "val_loss": 0.0035431724141484927,
      "val_auc_pr": 0.3718181818181818,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.05186235159635544
    },
    {
      "epoch": 51,
      "train_loss": 0.03975096909782371,
      "val_loss": 0.003855357279202768,
      "val_auc_pr": 0.37,
      "val_f1": 0.3809523773242631,
      "val_mae_log": 0.08433445543050766
    },
    {
      "epoch": 52,
      "train_loss": 0.040304526777283564,
      "val_loss": 0.003954493274380054,
      "val_auc_pr": 0.36705882352941177,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.0650041252374649
    },
    {
      "epoch": 53,
      "train_loss": 0.041316902365636184,
      "val_loss": 0.0044658422370308214,
      "val_auc_pr": 0.37444444444444447,
      "val_f1": 0.39999999680000003,
      "val_mae_log": 0.08514165133237839
    },
    {
      "epoch": 54,
      "train_loss": 0.041085500773545856,
      "val_loss": 0.003584100299381784,
      "val_auc_pr": 0.36991596638655466,
      "val_f1": 0.36363636012396694,
      "val_mae_log": 0.04943912476301193
    },
    {
      "epoch": 55,
      "train_loss": 0.04048956327543066,
      "val_loss": 0.003669723236401166,
      "val_auc_pr": 0.366961926961927,
      "val_f1": 0.34782608355387534,
      "val_mae_log": 0.0743192732334137
    },
    {
      "epoch": 56,
      "train_loss": 0.04016674624101536,
      "val_loss": 0.004304527521266469,
      "val_auc_pr": 0.3745588235294118,
      "val_f1": 0.39999999680000003,
      "val_mae_log": 0.08440288156270981
    }
  ],
  "conformal": {
    "alpha_0.01": {
      "conformal_metrics": {
        "alpha": 0.01,
        "target_coverage": 0.99,
        "marginal_coverage": 0.9700046146746655,
        "coverage_guarantee_met": false,
        "avg_set_size": 2.1033687125057683,
        "efficiency": 0.4741578218735579,
        "positive_coverage": 0.136986301369863,
        "negative_coverage": 0.9990448901623686,
        "set_size_distribution": {
          "2": 1948,
          "3": 214,
          "4": 5
        },
        "n_test": 2167,
        "mean_interval_width": 0.35249775648117065,
        "median_interval_width": 0.3299492597579956
      },
      "conformal_state": {
        "is_calibrated": true,
        "alpha": 0.01,
        "q_hat": 0.31530878875241947,
        "q_residual": 0.31530878875241947,
        "n_cal": 527,
        "tiers": {
          "LOW": [
            0.0,
            0.1
          ],
          "MODERATE": [
            0.1,
            0.4
          ],
          "HIGH": [
            0.4,
            0.7
          ],
          "CRITICAL": [
            0.7,
            1.0
          ]
        }
      }
    },
    "alpha_0.05": {
      "conformal_metrics": {
        "alpha": 0.05,
        "target_coverage": 0.95,
        "marginal_coverage": 0.9487771112136595,
        "coverage_guarantee_met": true,
        "avg_set_size": 1.9856945085371482,
        "efficiency": 0.503576372865713,
        "positive_coverage": 0.0,
        "negative_coverage": 0.9818529130850048,
        "set_size_distribution": {
          "1": 31,
          "2": 2136
        },
        "n_test": 2167,
        "mean_interval_width": 0.14139389991760254,
        "median_interval_width": 0.1266784965991974
      },
      "conformal_state": {
        "is_calibrated": true,
        "alpha": 0.05,
        "q_hat": 0.1120380280677236,
        "q_residual": 0.1120380280677236,
        "n_cal": 527,
        "tiers": {
          "LOW": [
            0.0,
            0.1
          ],
          "MODERATE": [
            0.1,
            0.4
          ],
          "HIGH": [
            0.4,
            0.7
          ],
          "CRITICAL": [
            0.7,
            1.0
          ]
        }
      }
    },
    "alpha_0.1": {
      "conformal_metrics": {
        "alpha": 0.1,
        "target_coverage": 0.9,
        "marginal_coverage": 0.9284725426857406,
        "coverage_guarantee_met": true,
        "avg_set_size": 1.103830179972312,
        "efficiency": 0.724042455006922,
        "positive_coverage": 0.0,
        "negative_coverage": 0.9608404966571156,
        "set_size_distribution": {
          "1": 1942,
          "2": 225
        },
        "n_test": 2167,
        "mean_interval_width": 0.060726769268512726,
        "median_interval_width": 0.05510023236274719
      },
      "conformal_state": {
        "is_calibrated": true,
        "alpha": 0.1,
        "q_hat": 0.04045976169647709,
        "q_residual": 0.04045976169647709,
        "n_cal": 527,
        "tiers": {
          "LOW": [
            0.0,
            0.1
          ],
          "MODERATE": [
            0.1,
            0.4
          ],
          "HIGH": [
            0.4,
            0.7
          ],
          "CRITICAL": [
            0.7,
            1.0
          ]
        }
      }
    },
    "alpha_0.2": {
      "conformal_metrics": {
        "alpha": 0.2,
        "target_coverage": 0.8,
        "marginal_coverage": 0.9220119981541302,
        "coverage_guarantee_met": true,
        "avg_set_size": 1.054453161052146,
        "efficiency": 0.7363867097369635,
        "positive_coverage": 0.0,
        "negative_coverage": 0.9541547277936963,
        "set_size_distribution": {
          "1": 2049,
          "2": 118
        },
        "n_test": 2167,
        "mean_interval_width": 0.04071307182312012,
        "median_interval_width": 0.039181869477033615
      },
      "conformal_state": {
        "is_calibrated": true,
        "alpha": 0.2,
        "q_hat": 0.024541400479014954,
        "q_residual": 0.024541400479014954,
        "n_cal": 527,
        "tiers": {
          "LOW": [
            0.0,
            0.1
          ],
          "MODERATE": [
            0.1,
            0.4
          ],
          "HIGH": [
            0.4,
            0.7
          ],
          "CRITICAL": [
            0.7,
            1.0
          ]
        }
      }
    }
  }
}