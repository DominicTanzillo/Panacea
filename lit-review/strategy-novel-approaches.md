# Generated by Claude Code — 2026-02-13
# Panacea: Novel Deep Learning Strategy for Orbital Collision Avoidance

## The Gap Nobody Has Filled

Every existing ML approach to CDM-based collision risk treats each conjunction event
as an **independent observation**. The Kelvins challenge winners, NASA CARA's attempts,
ESA's Kessler library — all process CDM sequences in isolation.

But the CRASH Clock paper (Thiele et al. 2025) proves the orbital environment is a
**coupled dynamical system** where:
- Collision rate scales as **n²** (density squared) — individual risk depends on population
- Maneuver cascades propagate uncertainty across the entire constellation
- Solar storms simultaneously degrade ALL predictions
- A single collision at 550 km altitude could trigger Kessler Syndrome

**The fundamental insight**: You cannot predict whether conjunction C₁ is dangerous
without knowing what else is happening in the orbital neighborhood. Yet every ML
model tries to do exactly this.

---

## Multi-Scale Orbital Risk Framework

We propose three complementary scales of prediction:

### Scale 1: MICRO — Event-Level CDM Risk (Existing, Enhanced)
> "Will THIS specific conjunction be dangerous?"

**Current state**: PI-TFT processes each CDM sequence independently.
**Enhancement**: Augment with population-level context features.

### Scale 2: MESO — Conjunction Network Risk (Novel)
> "How do concurrent conjunctions interact and cascade?"

**Approach**: Graph attention network connecting conjunction events that share
orbital shells, objects, or temporal proximity.

### Scale 3: MACRO — Population-Level Stress (Novel)
> "How fragile is the orbital environment right now?"

**Approach**: Real-time CRASH Clock estimation from TLE density distributions,
with ML corrections for non-random orbital configurations.

---

## Approach 1: Density-Augmented PI-TFT

**Novelty**: First CDM-based model to incorporate population-level orbital density.
**Complexity**: Low (feature engineering extension).
**Expected Impact**: Medium-High.

### New Features (added as static context)

| Feature | Source | Rationale |
|---------|--------|-----------|
| `shell_density` | TLE catalog at conjunction altitude | n² collision scaling |
| `shell_collision_rate` | Equation 2 from CRASH Clock | Direct risk metric |
| `shell_crash_clock` | τ_col per altitude bin | Time to expected collision |
| `n_active_conjunctions` | CDM dataset event count in altitude band | Operational load |
| `altitude_percentile` | CDF of RSO distribution | How crowded is this orbit |
| `starlink_fraction` | Fraction of objects that are Starlink | Dominant operator effect |

### Implementation
- Compute 1 km altitude bins from TLE catalog (same as CRASH Clock paper)
- For each CDM event, look up conjunction altitude → density features
- Add to PI-TFT's static feature vector (12 → 18 features)
- No architecture changes needed — just richer input

### Why This Works
The CRASH Clock paper shows that at 550 km, the collision timescale in that shell
alone is ~11 days. At 1200 km, it's years. A CDM event at 550 km with miss_distance
= 500m is categorically different from the same miss_distance at 1200 km — but
current models can't distinguish them because they don't see the neighborhood density.

---

## Approach 2: Orbital Risk Graph Network (OrbGraph)

**Novelty**: Very High — no published work on graph-structured CDM prediction.
**Complexity**: Medium (requires PyTorch Geometric or manual graph attention).
**Expected Impact**: High.

### Architecture
```
CDM Sequences ──→ PI-TFT Encoder ──→ Event Embeddings ──→ Graph Attention ──→ Risk
     (per event)         (shared)         (node features)      (message passing)

Graph Construction:
  Nodes = conjunction events
  Edges = { shared altitude shell (±50 km),
             shared object (same NORAD ID in target or chaser),
             temporal proximity (events within 7 days of each other) }
  Edge features = { altitude_overlap, relative_velocity_similarity,
                    time_between_TCAs, shared_object_flag }
```

### The Key Insight
If satellite A has a dangerous conjunction tomorrow, and satellite B (in the same
shell, same inclination band) has a conjunction next week, those events are NOT
independent. Satellite A's avoidance maneuver changes the risk landscape. The graph
captures this coupling.

### Implementation Options
1. **Full GNN**: PyTorch Geometric with GAT (Graph Attention Network) layers
2. **Lightweight**: Manual attention over k-nearest events in altitude space
3. **Hybrid**: Use density features (Approach 1) as a cheap proxy for graph structure

### Feasibility for Class Project
- Kelvins dataset has 13K events — enough for meaningful graphs
- Events at similar altitudes are naturally connected
- Can demonstrate on subset and show improvement over independent prediction
- If GNN is too complex, the lightweight attention version achieves similar effect

---

## Approach 3: CRASH Clock Neural Estimator

**Novelty**: Medium — ML approximation of known analytical formula.
**Complexity**: Low.
**Expected Impact**: High for demo, Medium for research.

### Concept
The analytical CRASH Clock (Equation 2) assumes random orbit distribution within
shells. But real orbits are structured (constellations have designed phases). A neural
network can learn the **correction factor** between:
- Analytical CRASH Clock (random assumption) → ground truth
- Actual collision rate from N-body simulation → target

### Architecture
```
TLE Catalog ──→ Density Histogram (200 altitude bins)
             ──→ Inclination Distribution
             ──→ Eccentricity Distribution
             ──→ Object Type Counts
                    ↓
              1D CNN / MLP ──→ CRASH Clock Estimate (days)
                             ──→ Per-Shell Risk Decomposition (200 values)
                             ──→ Confidence Interval
```

### Training Data
- Generate 1000+ snapshots from historical TLE catalogs (Space-Track has daily TLEs)
- Compute analytical CRASH Clock for each snapshot
- Run N-body simulation for validation subset
- Train to predict: analytical value + correction for non-random structure

### Webapp Integration
- Live CRASH Clock display on the 3D globe
- Color altitude shells by risk (red = high density, green = safe)
- Show how launching X more satellites at Y altitude changes the Clock

---

## Approach 4: Conformal Prediction Sets for Risk Bounds

**Novelty**: High — no CDM model provides calibrated uncertainty guarantees.
**Complexity**: Low (post-hoc calibration on existing model).
**Expected Impact**: Very High for operational relevance.

### Concept
Instead of: "This conjunction has 23% collision probability"
Output: "With 95% confidence, the risk is between [HIGH, CRITICAL]"

Conformal prediction provides **distribution-free** coverage guarantees:
- No assumptions about the data distribution
- Works on top of any base model (our PI-TFT)
- Mathematically guaranteed coverage: P(true label ∈ prediction set) ≥ 1-α

### Implementation
```python
# 1. Split calibration set from test data
# 2. Compute nonconformity scores on calibration set
#    s_i = 1 - f(x_i)[y_i]  (softmax probability of true class)
# 3. Find quantile q̂ = Quantile(s_1...s_n, (n+1)(1-α)/n)
# 4. For new x: C(x) = {y : f(x)[y] ≥ 1 - q̂}
```

### Why This Addresses the Fundamental Problem
NASA CARA's biggest criticism: "need for explainable outcomes, not black-box models."
Conformal prediction doesn't make the model explainable, but it makes the uncertainty
**trustworthy**. An operator can say: "The model says MODERATE risk, and it's
guaranteed to be correct 95% of the time." That's actionable.

### Triage Integration
- LOW confidence: automated pass (no human review)
- MODERATE with narrow band: flagged for review
- MODERATE with wide band [LOW, CRITICAL]: urgent human review
- CRITICAL: immediate maneuver planning

---

## Approach 5: Space Weather-Conditioned Risk

**Novelty**: High — no CDM model conditions on real-time environmental state.
**Complexity**: Medium.
**Expected Impact**: High.

### The Problem
During the May 2024 Gannon storm, positional uncertainties reached several km.
The CRASH Clock effectively dropped from 5.5 days to hours. But CDM-based models
trained on fair-weather data have no way to capture this.

### Features
| Feature | Source | Lag |
|---------|--------|-----|
| F10.7 (solar flux) | NOAA SWPC | Real-time |
| Kp (geomagnetic activity) | NOAA SWPC | 3-hour |
| Dst (disturbance storm time) | Kyoto WDC | 1-hour |
| Ap (daily geomagnetic index) | Already in Kelvins data | Daily |
| Thermospheric density anomaly | JB2008 model or ML prediction | Real-time |
| Drag coefficient uncertainty | Estimated from recent OD residuals | Per-CDM |

### Architecture Extension
Add a **storm gate** to PI-TFT:
```
Space Weather Vector ──→ MLP ──→ σ(gate) ──→ multiply with risk logit

When storm gate > 0.5: "environmental conditions degrade all predictions"
  → widen confidence intervals
  → increase risk estimates
  → flag for human review regardless of model output
```

### Training Approach
- Kelvins data has F10, AP, F3M, SSN columns — currently underexploited
- Augment with synthetic storm scenarios (scale positional uncertainties during F10 > 200)
- Multi-task: predict risk AND predict whether OD quality is degraded

---

## Approach 6: Multi-Radius Near-Miss Flagging

**Novelty**: Medium — extends screening to multiple distance thresholds.
**Complexity**: Low.
**Expected Impact**: High for operational relevance.

### Concept (from user's idea about "radii")
Instead of binary risk (safe/dangerous), predict a **risk profile** across multiple
distance thresholds:

```
Conjunction Event ──→ Model ──→ {
  P(miss < 10 m)   = 0.002  ← collision probable
  P(miss < 100 m)  = 0.015  ← collision possible
  P(miss < 1 km)   = 0.180  ← maneuver needed
  P(miss < 10 km)  = 0.750  ← monitoring needed
  P(miss < 100 km) = 0.990  ← conjunction identified
}
```

### Implementation
- Multi-head output: 5 sigmoid heads, one per distance threshold
- Ordinal constraint: P(miss < r₁) ≤ P(miss < r₂) for r₁ < r₂
- Loss: sum of binary cross-entropies with ordinal regularization
- Maps directly to CRASH Clock distance thresholds (10m, 5m, 10cm)

### Webapp Visualization
- Concentric rings around conjunction point on globe
- Color gradient: green (100km) → yellow (10km) → orange (1km) → red (100m) → black (10m)
- Each ring shows the probability of miss distance falling within

---

## Recommended Implementation Order

### Phase A: Quick Wins (1-2 days each)
1. **Density-Augmented Features** (Approach 1) — add to existing PI-TFT, retrain
2. **Conformal Prediction** (Approach 4) — post-hoc on existing models
3. **Multi-Radius Heads** (Approach 6) — modify PI-TFT output layer

### Phase B: Novel Architecture (3-5 days)
4. **OrbGraph** (Approach 2) — graph attention on conjunction network
5. **Storm Gate** (Approach 5) — space weather conditioning

### Phase C: Webapp Features (2-3 days)
6. **CRASH Clock Estimator** (Approach 3) — live display on globe
7. **Conjunction Risk Visualization** — multi-radius rings, risk heatmap

### Phase D: Experiments & Paper
8. Ablation: baseline → +density → +graph → +conformal → +storm
9. Compare all approaches on Kelvins test set
10. Staleness experiment across all approaches

---

## Class Rubric Compliance

### Three Models ✓
1. **Naive Baseline**: Altitude-based prior (AUC-PR ~0.06) — already done
2. **Classical ML**: XGBoost + density-augmented features (AUC-PR ~0.98) — extend existing
3. **Deep Learning**: Graph-augmented PI-TFT with conformal calibration — the novel contribution

### Focused Experiment ✓
- **Primary**: TLE staleness sensitivity (already planned)
- **Secondary**: Density augmentation ablation (does population context help?)
- **Tertiary**: Graph vs independent event comparison

### Interactive Web Application ✓
- 3D globe with live satellite positions (already working)
- CRASH Clock display + density heatmap (new)
- Conjunction risk screening with multi-radius visualization (new)
- Model comparison dashboard (already planned)

### Novel Contribution ✓
- **No published work** combines CDM-level features with population-level density metrics
- **No published work** uses graph attention for conjunction risk propagation
- **No published work** applies conformal prediction to CDM risk assessment
- Directly addresses gaps identified by NASA CARA, ESA, and CRASH Clock paper

---

## Why This Matters Beyond the Classroom

The CRASH Clock is 5.5 days. That means the margin between "everything is fine"
and "catastrophic orbital debris cascade" is less than a week. The current system
depends on:
1. Perfect situational awareness (breaks during solar storms)
2. Perfect communication between operators (failed in 2019 ESA-SpaceX incident)
3. Perfect maneuver execution (each creates 40 km uncertainty)
4. Zero software bugs in alert systems (SpaceX had one in 2019)

A model that can:
- Predict risk considering the FULL orbital neighborhood (not just one event)
- Provide calibrated uncertainty bounds (not just a point estimate)
- Adjust predictions during degraded environmental conditions (storms)
- Flag cascade risks before they materialize

...would be a genuine contribution to space safety. Not a toy demo — a tool that
NASA CARA, ESA ESOC, or SpaceX could actually evaluate for operational use.

The medical residency parallel: this is like building a cardiac arrest risk model that
considers not just the patient's vitals, but the ICU census, nurse-to-patient ratio,
and equipment availability. Individual risk depends on system capacity.
